#!/usr/bin/env node

var path          = require('path');
var program       = require('commander');
var blessed       = require('blessed');
var bootstrap     = require('../src/bootstrap');
var UserInterface = require('../src/ui');
var Application   = require('../src/app/main');
var configFile    = path.resolve(process.env.HOME, './.qi.json');

program
  .version('2.0.0')
  .option('--clear-cache', 'Clears the cache')
  .parse(process.argv);

process.title = 'qissues';

var container = bootstrap(configFile);

if(program.clearCache) {
  container.get('cache').invalidateAll();
}

var app = new Application(container);
app.start(
  new UserInterface(process.stdin, process.stdout)
);
app.exit = process.exit;
